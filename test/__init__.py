def segment_text_by_keyword(text, keyword, max_length=1000):
    # 使用关键词分割文本，并保留分割前的关键词
    segments = text.split(keyword)

    # 初始化结果列表
    result = []
    current_segment = ""

    # 遍历分割后的文本片段，按需合并为1000字一段
    for i, segment in enumerate(segments):
        # 如果不是第一个片段，前面需要加上关键词
        if i > 0:
            segment = keyword + segment

        # 检查当前片段的长度，如果加上当前片段后不超过最大长度，则添加到当前段落
        if len(current_segment) + len(segment) <= max_length:
            current_segment += segment
        else:
            # 当前段落已经超过最大长度，保存当前段落并开始新的段落
            if current_segment.strip():
                result.append(current_segment)
            current_segment = segment

    # 添加最后的段落
    if current_segment:
        result.append(current_segment)

    return result


# 测试代码
text = """
主持人 02:27
遇见投资人一起遇见未来，大家好，本期我们遇见的投资人是KKR的合伙人孙征，孙总，欢迎您。
孙铮 02:35
你好杨老师
主持人02:36
今天我们先从KKR在中国的并购历史聊起，就是kr在中国发展也有18年的时间了，您能和我们分享一下我们在中国并购的发展历程。
孙铮 02:47
对KKR是在2006年的时候来亚洲，然后最早是在香港成立办公室，然后我们在北京办公室是在2008年成立，今天办公室是在2010年的时候正式搬进来的。过去这18年接近接近20年的时间当中，其实我们的投资策略也经历了一些变化和演进，在前10年到12年的时间当中，我们其实主要还是做一些少数股权的投资，这里面包含像现代牧业，包括我们做了 A股上市的青岛海尔圣农发展，联合环境一系列这样的，其实有些我们在里面是占有就是第一大的财务投资人的这样的一个股权，都还是一个二股东这样的方式。
我们真正做并购，因为今天的话题主要是做并购，并购是从大概16 17年左右开始做了一些集中精力去做了一些并购的投资，到今天我们大概一共做了七八单，目前我们还持有的一些并购项目，包括一个连锁的药店的企业叫权益健康，包括国内比较知名的一个照明的企业叫雷士照明，包括我们在江苏投了一家做食用菌的一个生产型的企业，叫玉冠现代农业，我们还去做了一个跟它相关的上游的菌种的并购全球的菌种的一个企业叫世尔丰。我还有一家是在其实是在新西兰的一家企业，叫 K九宠物食品的品牌公司，当然还有一家医院平台的医疗服务医院平台的这样的一个控股的标的，我们觉得过往做的这些并购的交易和我们最初在中国做的少数股权投资，其实有几个比较明显的差别，战略上的一些变化。
第一个就是说从行业的投资逻辑来看，投少股小少数股权主要的投资逻辑其实是投成长，对，因为我们在里面没有更多的一个财务杠杆，或者是一些金融工程的工具可以用，主要就是靠企业自身的成长，所以大部分的项目要么是在上市前投资，通过它自身的发展，企业成熟去实现上市，然后我们再资本市场实现退出，或者是
说话人2 05:30
关于这个问题麻烦你重问一下，
主持人06:51
这个问题，好的，我们开始。孙总 K来进入中国也有快18年的时间了，今天第一个问题也想请您先分享一下KKR在中国整个投资并购的历程。
"""

keyword = "主持人"
segmented_text = segment_text_by_keyword(text, keyword, 3)

# 输出分割结果
for idx, segment in enumerate(segmented_text, 1):
    print(f"段落 {idx}: {segment[:10000]}")  # 输出每段前100个字符预览
